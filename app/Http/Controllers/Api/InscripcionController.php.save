#  PANEL DE ADMINISTRACIN COMPLETO
## Sistema de Gesti贸n de Pileta - Villa Mitre

---

## 锟斤拷 ARCHIVOS A INSTALAR

### BACKEND (Laravel)

#### 1. Controladores en `app/Http/Controllers/Api/`:

**ProfesorController.php** - [Ver arriba]
**NivelController.php** - [Ver arriba]  
**TurnoController.php** - [Ver arriba]

**InscripcionController.php**:
```php
<?php
namespace App\Http\Controllers\Api;
use App\Http\Controllers\Controller;
use App\Models\Inscripcion;
use Illuminate\Http\Request;

class InscripcionController extends Controller
{
    public function store(Request $request)
    {
        $validated = $request->validate([
            'turno_id' => 'required|exists:turnos,id',
            'alumno_id' => 'required|exists:users,id',
            'fecha_inscripcion' => 'required|date',
        ]);

        $validated['estado'] = 'activo';
        $validated['pase_libre'] = false;

        $inscripcion = Inscripcion::create($validated);

        return response()->json([
            'success' => true,
            'message' => 'Inscripci贸n creada exitosamente',
            'data' => $inscripcion,
        ], 201);
    }

    public function destroy($id)
    {
        $inscripcion = Inscripcion::findOrFail($id);
        $inscripcion->delete();

        return response()->json([
            'success' => true,
            'message' => 'Inscripci贸n eliminada exitosamente',
        ]);
    }

    public function getPorTurno($turnoId)
    {
        $inscripciones = Inscripcion::where('turno_id', $turnoId)
            ->with('alumno')
            ->get();

        return response()->json([
            'success' => true,
            'data' => $inscripciones,
        ]);
    }
}
```

**AlumnoController.php**:
```php
<?php
namespace App\Http\Controllers\Api;
use App\Http\Controllers\Controller;
use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;

class AlumnoController extends Controller
{
    public function index(Request $request)
    {
        $query = User::where('tipo_usuario', 'cliente');

        if ($request->has('search')) {
            $search = $request->search;
            $query->where(function($q) use ($search) {
                $q->where('nombre', 'like', "%{$search}%")
                  ->orWhere('apellido', 'like', "%{$search}%")
                  ->orWhere('dni', 'like', "%{$search}%");
            });
        }

        $alumnos = $query->orderBy('apellido')->orderBy('nombre')->get();

        return response()->json(['success' => true, 'data' => $alumnos]);
    }

    public function store(Request $request)
    {
        $validated = $request->validate([
            'nombre' => 'required|string|max:255',
            'apellido' => 'required|string|max:255',
            'dni' => 'required|string|unique:users,dni',
            'telefono' => 'required|string',
            'email' => 'nullable|email|unique:users,email',
            'tipo_cliente' => 'required|in:normal,pase_libre',
        ]);

        $alumno = User::create([
            'nombre' => $validated['nombre'],
            'apellido' => $validated['apellido'],
            'dni' => $validated['dni'],
            'telefono' => $validated['telefono'],
            'email' => $validated['email'] ?? null,
            'password' => Hash::make($validated['dni']),
            'tipo_usuario' => 'cliente',
            'tipo_cliente' => $validated['tipo_cliente'],
            'activo' => true,
        ]);

        return response()->json([
            'success' => true,
            'message' => 'Alumno creado exitosamente',
            'data' => $alumno,
        ], 201);
    }

    public function inasistentes()
    {
        return response()->json(['success' => true, 'data' => []]);
    }
}
```

#### 2. Rutas API (`routes/api.php`):

```php
<?php
use Illuminate\Support\Facades\Route;
use App\Http\Controllers\Api\AuthController;
use App\Http\Controllers\Api\TurnoController;
use App\Http\Controllers\Api\InscripcionController;
use App\Http\Controllers\Api\AlumnoController;
use App\Http\Controllers\Api\ProfesorController;
use App\Http\Controllers\Api\NivelController;

Route::post('/login', [AuthController::class, 'login']);

Route::middleware('auth:sanctum')->group(function () {
    Route::post('/logout', [AuthController::class, 'logout']);
    Route::get('/me', [AuthController::class, 'me']);
    
    // Turnos
    Route::apiResource('turnos', TurnoController::class);
    Route::get('/turnos/{id}/inscripciones', [TurnoController::class, 'inscripciones']);
    
    // Inscripciones
    Route::post('/inscripciones', [InscripcionController::class, 'store']);
    Route::delete('/inscripciones/{id}', [InscripcionController::class, 'destroy']);
    Route::get('/turnos/{turnoId}/inscripciones', [InscripcionController::class, 'getPorTurno']);
    
    // Alumnos
    Route::apiResource('alumnos', AlumnoController::class);
    Route::get('/alumnos/inasistentes', [AlumnoController::class, 'inasistentes']);
    
    // Profesores (ADMIN)
    Route::apiResource('profesores', ProfesorController::class);
    
    // Niveles (ADMIN)
    Route::apiResource('niveles', NivelController::class);
});
```

---

### FRONTEND (React)

#### 1. Actualizar API Service (`src/services/api.js`):

Agregar al final:

```javascript
// PROFESORES (ADMIN)
export const profesoresAPI = {
  getAll: () => api.get('/profesores'),
  getById: (id) => api.get(`/profesores/${id}`),
  create: (data) => api.post('/profesores', data),
  update: (id, data) => api.put(`/profesores/${id}`, data),
  delete: (id) => api.delete(`/profesores/${id}`),
};

// NIVELES (ADMIN)
export const nivelesAPI = {
  getAll: () => api.get('/niveles'),
  getById: (id) => api.get(`/niveles/${id}`),
  create: (data) => api.post('/niveles', data),
  update: (id, data) => api.put(`/niveles/${id}`, data),
  delete: (id) => api.delete(`/niveles/${id}`),
};

// TURNOS (ADMIN)
export const turnosAdminAPI = {
  create: (data) => api.post('/turnos', data),
  update: (id, data) => api.put(`/turnos/${id}`, data),
  delete: (id) => api.delete(`/turnos/${id}`),
};
```

#### 2. Dashboard Principal actualizado (`src/pages/DashboardPage.jsx`):

Reemplazar con:

```javascript
import { Navigate } from 'react-router-dom';
import useAuthStore from '../stores/useAuthStore';
import SecretariaDashboard from '../components/dashboards/SecretariaDashboard';
import ProfesorDashboard from '../components/dashboards/ProfesorDashboard';
import ClienteDashboard from '../components/dashboards/ClienteDashboard';
import AdminDashboard from '../components/dashboards/AdminDashboard';

export default function DashboardPage() {
  const user = useAuthStore((state) => state.user);

  if (!user) {
    return <Navigate to="/login" replace />;
  }

  // Coordinador y Secretaria ven el panel de administraci贸n
  if (user.tipo_usuario === 'coordinador' || user.tipo_usuario === 'secretaria') {
    return <AdminDashboard />;
  }

  switch (user.tipo_usuario) {
    case 'profesor':
      return <ProfesorDashboard />;
    case 'cliente':
      return <ClienteDashboard />;
    default:
      return <div>Tipo de usuario no reconocido</div>;
  }
}
```

---

##  INSTRUCCIONES DE INSTALACIN

### PASO 1: Backend Laravel

```bash
# 1. Copiar controladores
cp ProfesorController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp NivelController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp TurnoController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp InscripcionController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp AlumnoController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/

# 2. Actualizar routes/api.php (copiar contenido de arriba)

# 3. Limpiar cach茅
cd ~/Escritorio/Trabajo/Pileta/sistema-turnos
php artisan route:clear
php artisan config:clear

# 4. Reiniciar Laravel
Ctrl+C en terminal de php artisan serve
php artisan serve
```

### PASO 2: Frontend React

Los componentes del panel admin son muy extensos. Voy a crear archivos individuales para descargar.

---
#  PANEL DE ADMINISTRACIN COMPLETO
## Sistema de Gesti贸n de Pileta - Villa Mitre

---

## 锟斤拷 ARCHIVOS A INSTALAR

### BACKEND (Laravel)

#### 1. Controladores en `app/Http/Controllers/Api/`:

**ProfesorController.php** - [Ver arriba]
**NivelController.php** - [Ver arriba]  
**TurnoController.php** - [Ver arriba]

**InscripcionController.php**:
```php
<?php
namespace App\Http\Controllers\Api;
use App\Http\Controllers\Controller;
use App\Models\Inscripcion;
use Illuminate\Http\Request;

class InscripcionController extends Controller
{
    public function store(Request $request)
    {
        $validated = $request->validate([
            'turno_id' => 'required|exists:turnos,id',
            'alumno_id' => 'required|exists:users,id',
            'fecha_inscripcion' => 'required|date',
        ]);

        $validated['estado'] = 'activo';
        $validated['pase_libre'] = false;

        $inscripcion = Inscripcion::create($validated);

        return response()->json([
            'success' => true,
            'message' => 'Inscripci贸n creada exitosamente',
            'data' => $inscripcion,
        ], 201);
    }

    public function destroy($id)
    {
        $inscripcion = Inscripcion::findOrFail($id);
        $inscripcion->delete();

        return response()->json([
            'success' => true,
            'message' => 'Inscripci贸n eliminada exitosamente',
        ]);
    }

    public function getPorTurno($turnoId)
    {
        $inscripciones = Inscripcion::where('turno_id', $turnoId)
            ->with('alumno')
            ->get();

        return response()->json([
            'success' => true,
            'data' => $inscripciones,
        ]);
    }
}
```

**AlumnoController.php**:
```php
<?php
namespace App\Http\Controllers\Api;
use App\Http\Controllers\Controller;
use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;

class AlumnoController extends Controller
{
    public function index(Request $request)
    {
        $query = User::where('tipo_usuario', 'cliente');

        if ($request->has('search')) {
            $search = $request->search;
            $query->where(function($q) use ($search) {
                $q->where('nombre', 'like', "%{$search}%")
                  ->orWhere('apellido', 'like', "%{$search}%")
                  ->orWhere('dni', 'like', "%{$search}%");
            });
        }

        $alumnos = $query->orderBy('apellido')->orderBy('nombre')->get();

        return response()->json(['success' => true, 'data' => $alumnos]);
    }

    public function store(Request $request)
    {
        $validated = $request->validate([
            'nombre' => 'required|string|max:255',
            'apellido' => 'required|string|max:255',
            'dni' => 'required|string|unique:users,dni',
            'telefono' => 'required|string',
            'email' => 'nullable|email|unique:users,email',
            'tipo_cliente' => 'required|in:normal,pase_libre',
        ]);

        $alumno = User::create([
            'nombre' => $validated['nombre'],
            'apellido' => $validated['apellido'],
            'dni' => $validated['dni'],
            'telefono' => $validated['telefono'],
            'email' => $validated['email'] ?? null,
            'password' => Hash::make($validated['dni']),
            'tipo_usuario' => 'cliente',
            'tipo_cliente' => $validated['tipo_cliente'],
            'activo' => true,
        ]);

        return response()->json([
            'success' => true,
            'message' => 'Alumno creado exitosamente',
            'data' => $alumno,
        ], 201);
    }

    public function inasistentes()
    {
        return response()->json(['success' => true, 'data' => []]);
    }
}
```

#### 2. Rutas API (`routes/api.php`):

```php
<?php
use Illuminate\Support\Facades\Route;
use App\Http\Controllers\Api\AuthController;
use App\Http\Controllers\Api\TurnoController;
use App\Http\Controllers\Api\InscripcionController;
use App\Http\Controllers\Api\AlumnoController;
use App\Http\Controllers\Api\ProfesorController;
use App\Http\Controllers\Api\NivelController;

Route::post('/login', [AuthController::class, 'login']);

Route::middleware('auth:sanctum')->group(function () {
    Route::post('/logout', [AuthController::class, 'logout']);
    Route::get('/me', [AuthController::class, 'me']);
    
    // Turnos
    Route::apiResource('turnos', TurnoController::class);
    Route::get('/turnos/{id}/inscripciones', [TurnoController::class, 'inscripciones']);
    
    // Inscripciones
    Route::post('/inscripciones', [InscripcionController::class, 'store']);
    Route::delete('/inscripciones/{id}', [InscripcionController::class, 'destroy']);
    Route::get('/turnos/{turnoId}/inscripciones', [InscripcionController::class, 'getPorTurno']);
    
    // Alumnos
    Route::apiResource('alumnos', AlumnoController::class);
    Route::get('/alumnos/inasistentes', [AlumnoController::class, 'inasistentes']);
    
    // Profesores (ADMIN)
    Route::apiResource('profesores', ProfesorController::class);
    
    // Niveles (ADMIN)
    Route::apiResource('niveles', NivelController::class);
});
```

---

### FRONTEND (React)

#### 1. Actualizar API Service (`src/services/api.js`):

Agregar al final:

```javascript
// PROFESORES (ADMIN)
export const profesoresAPI = {
  getAll: () => api.get('/profesores'),
  getById: (id) => api.get(`/profesores/${id}`),
  create: (data) => api.post('/profesores', data),
  update: (id, data) => api.put(`/profesores/${id}`, data),
  delete: (id) => api.delete(`/profesores/${id}`),
};

// NIVELES (ADMIN)
export const nivelesAPI = {
  getAll: () => api.get('/niveles'),
  getById: (id) => api.get(`/niveles/${id}`),
  create: (data) => api.post('/niveles', data),
  update: (id, data) => api.put(`/niveles/${id}`, data),
  delete: (id) => api.delete(`/niveles/${id}`),
};

// TURNOS (ADMIN)
export const turnosAdminAPI = {
  create: (data) => api.post('/turnos', data),
  update: (id, data) => api.put(`/turnos/${id}`, data),
  delete: (id) => api.delete(`/turnos/${id}`),
};
```

#### 2. Dashboard Principal actualizado (`src/pages/DashboardPage.jsx`):

Reemplazar con:

```javascript
import { Navigate } from 'react-router-dom';
import useAuthStore from '../stores/useAuthStore';
import SecretariaDashboard from '../components/dashboards/SecretariaDashboard';
import ProfesorDashboard from '../components/dashboards/ProfesorDashboard';
import ClienteDashboard from '../components/dashboards/ClienteDashboard';
import AdminDashboard from '../components/dashboards/AdminDashboard';

export default function DashboardPage() {
  const user = useAuthStore((state) => state.user);

  if (!user) {
    return <Navigate to="/login" replace />;
  }

  // Coordinador y Secretaria ven el panel de administraci贸n
  if (user.tipo_usuario === 'coordinador' || user.tipo_usuario === 'secretaria') {
    return <AdminDashboard />;
  }

  switch (user.tipo_usuario) {
    case 'profesor':
      return <ProfesorDashboard />;
    case 'cliente':
      return <ClienteDashboard />;
    default:
      return <div>Tipo de usuario no reconocido</div>;
  }
}
```

---

##  INSTRUCCIONES DE INSTALACIN

### PASO 1: Backend Laravel

```bash
# 1. Copiar controladores
cp ProfesorController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp NivelController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp TurnoController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp InscripcionController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/
cp AlumnoController.php ~/Escritorio/Trabajo/Pileta/sistema-turnos/app/Http/Controllers/Api/

# 2. Actualizar routes/api.php (copiar contenido de arriba)

# 3. Limpiar cach茅
cd ~/Escritorio/Trabajo/Pileta/siste
